{"version":3,"sources":["scripts/app.js"],"names":["angular","module","localBookService","$rootScope","$q","service","books","SaveState","sessionStorage","userService","toJson","resolve","RestoreState","fromJson","Remove","book","index","indexOf","splice","Add","push","$inject","bookService","api","$resource","callback","key","get","method","navbar","NavbarController","$mdToast","$window","$state","vm","this","go","term","$emit","searchTerm","goSearch","txtSearch","show","simple","textContent","position","hideDelay","document","querySelector","focus","current","name","promisse","then","directive","restrict","replace","templateUrl","controller","controllerAs","bindToController","cardBook","CardBookController","$scope","$mdDialog","openBookDetail","ev","local","cancel","targetEvent","clickOutsideToClose","fullscreen","addToFavorites","removeToFavorites","confirm","title","ariaLabel","ok","confirmRemoveToFavorites","scope","items","router","MainController","searching","totalItems","startIndex","maxResults","totalPages","search","q","resp","Math","ceil","$on","event","data","highlight","text","phrase","RegExp","filter","FavoritesController","routerConfig","$stateProvider","$urlRouterProvider","state","url","otherwise","config","constant","run","$templateCache","put"],"mappings":"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","file":"scripts/app-bf284a1195.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular\n    .module('book', ['ngSanitize', 'ngAria', 'ngResource', 'ui.router', 'ngMaterial', 'toastr']);\n})();\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n      .module('book')\r\n      .service('localBookService', localBookService);\r\n\r\n  /** @ngInject */\r\n  function localBookService($rootScope, $q) {\r\n\r\n    var service = {\r\n\r\n        books: [],\r\n\r\n        SaveState: function () {\r\n            sessionStorage.userService = angular.toJson(service.books);\r\n            return $q.resolve(sessionStorage.userService);\r\n        },\r\n\r\n        RestoreState: function () {\r\n            service.books = angular.fromJson(sessionStorage.userService) || [];\r\n        },\r\n\r\n        Remove: function (book) {\r\n            var index = service.books.indexOf(book);\r\n            service.books.splice(index, 1); \r\n            return service.SaveState();\r\n        },\r\n\r\n        Add : function(book){\r\n          service.books.push(book);\r\n          return service.SaveState();\r\n        }\r\n    }\r\n\r\n    return service;\r\n  }\r\n\r\n})();\n(function() {\n  'use strict';\n\n  angular\n      .module('book')\n      .service('bookService', bookService);\n\n  /** @ngInject */\n  function bookService(api, $resource) {\n\n      return $resource(api,\n        {\n          callback: 'JSON_CALLBACK',\n          key: 'AIzaSyATldFLGtPPZVLecasP0nFXkX6RqXa7VEI'\n        },\n        {\n          get: {\n            method: 'JSONP'\n          }\n        });\n  }\n\n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('book')\n    .directive('navbar', navbar);\n\n  /** @ngInject */\n  function navbar() {\n    var directive = {\n      restrict: 'A',\n      replace:true,\n      templateUrl: 'app/components/navbar/navbar.html',\n      controller: NavbarController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function NavbarController($rootScope, $mdToast, $window, $state) {\n      var vm = this;\n\n      vm.go = function(term){\n        $rootScope.$emit('searching', {searchTerm:term});\n      }\n      \n      vm.goSearch = function(){\n        if(!vm.txtSearch){\n\n          $mdToast.show(\n            $mdToast.simple()\n              .textContent('Digite o nome do livro')\n              .position('bottom center')\n              .hideDelay(3000)\n          );\n          $window.document.querySelector('#input-search').focus();\n          return false;\n        }\n\n        if($state.current.name !== 'home'){\n          var promisse = $state.go('home');\n          promisse.then(function(){\n            vm.go(vm.txtSearch);\n          });\n        }else{\n          vm.go(vm.txtSearch);\n        }\n      }\n    }\n  }\n\n})();\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('book')\r\n    .directive('cardBook', cardBook);\r\n\r\n  /** @ngInject */\r\n  function cardBook() {\r\n    var directive = {\r\n      restrict: 'A',\r\n      scope: {\r\n        items : '=',\r\n        searchTerm : '@',\r\n        router : '@'\r\n      },\r\n      templateUrl: 'app/components/card/card.html',\r\n      controller: CardBookController,\r\n      controllerAs: 'card',\r\n      bindToController: true\r\n    };\r\n\r\n    return directive;\r\n\r\n    /** @ngInject */\r\n    function CardBookController($scope, $mdDialog, localBookService, $mdToast) {\r\n      var vm = this;\r\n\r\n      /* abre o modal de detalhes do livro */\r\n      vm.openBookDetail = function(ev, book) {\r\n        $mdDialog.show({\r\n          controller: function(local){\r\n            var vm = this;\r\n            vm.book = local.book;\r\n\r\n            vm.cancel = function(){\r\n              $mdDialog.cancel();\r\n            }\r\n          },\r\n          templateUrl: 'app/components/bookDialog.html',\r\n          controllerAs: 'dialog',\r\n          local: { 'book': book},\r\n          targetEvent: ev,\r\n          clickOutsideToClose:true,\r\n          fullscreen: true\r\n        });\r\n      }\r\n\r\n      /* add o filme ao favoritos */\r\n      vm.addToFavorites = function(book){\r\n\r\n        localBookService.Add(book).then(function(){\r\n          $mdToast.show(\r\n            $mdToast.simple()\r\n              .textContent('Livro Adicionado com sucesso')\r\n              .position('bottom center')\r\n              .hideDelay(3000)\r\n          );\r\n        });\r\n      }\r\n\r\n      /* custom dialog com a chamada para remocao */\r\n      vm.removeToFavorites = function(ev, book) {\r\n        // Appending dialog to document.body to cover sidenav in docs app\r\n        var confirm = $mdDialog.confirm()\r\n              .title('Remover Livro')\r\n              .textContent('Tem certeza que deseja remover este livro?')\r\n              .ariaLabel('Remover Livro')\r\n              .targetEvent(ev)\r\n              .ok('Confirmar')\r\n              .cancel('Cancelar');\r\n\r\n        $mdDialog.show(confirm).then(function() {\r\n          vm.confirmRemoveToFavorites(book);\r\n        }, function() {\r\n          // todo negate\r\n        });\r\n      }\r\n\r\n      /* confirmacao da remocao */\r\n      vm.confirmRemoveToFavorites = function(book){\r\n        localBookService.Remove(book).then(function(){\r\n          $mdToast.show(\r\n            $mdToast.simple()\r\n              .textContent('Livro removido com sucesso')\r\n              .position('bottom center')\r\n              .hideDelay(3000)\r\n          );\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n})();\r\n\n(function() {\n  'use strict';\n\n  angular\n    .module('book')\n    .controller('MainController', MainController);\n\n  /** @ngInject */\n  function MainController(bookService, $scope, localBookService, $mdDialog, $rootScope) {\n    var vm = this;\n    vm.searching = false;\n    vm.searchTerm = '';\n    vm.totalItems = 0;\n    vm.startIndex = 0;\n    vm.maxResults = 40;\n    vm.totalPages = 0;\n\n    /* realiza a pesquisa no google */\n    vm.search = function(index){\n\n      vm.items = [];\n      vm.searching = true;\n      vm.startIndex = index;\n\n      bookService.get({ q: vm.searchTerm, startIndex : (index * vm.maxResults), maxResults : vm.maxResults }, function (resp) {\n        vm.items = resp.items;\n        vm.totalItems = resp.totalItems;\n        vm.totalPages = Math.ceil(vm.totalItems / vm.maxResults);\n        vm.searching = false;\n      });\n    }\n\n    /* escuta o evento para realizar a pesquisa no main */\n    var searching = $rootScope.$on('searching', function(event, data){\n      vm.searchTerm = data.searchTerm;\n      vm.search(0);\n    });\n\n    /* destroy o evento pra nao ter que ficar fazendo varias pesquisas ao mesmo tempo */\n    $scope.$on('$destroy', function() {\n        searching();\n    });\n\n  }\n})();\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n      .module('book')\r\n      .filter('highlight', highlight);\r\n\r\n\t/** @ngInject */\r\n\tfunction highlight() {\r\n\t\treturn function(text, phrase) {\r\n\t\t\treturn (phrase && text) ? text.replace(new RegExp('('+phrase+')', 'gi'), '<kbd>$1</kbd>') : text;\r\n\t\t}\r\n\t}\r\n\r\n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('book')\n    .controller('FavoritesController', FavoritesController);\n\n  /** @ngInject */\n  function FavoritesController(bookService, $scope, localBookService) {\n    var vm = this;\n\n    localBookService.RestoreState();\n\n    vm.items = localBookService.books;\n  }\n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('book')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('home', {\n        url: '/',\n        templateUrl: 'app/main/main.html',\n        controller: 'MainController',\n        controllerAs: 'main'\n      })\n      .state('favorites', {\n        url: '/favorites',\n        templateUrl: 'app/favorites/favorites.html',\n        controller: 'FavoritesController',\n        controllerAs: 'favorites'\n      });\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('book')\n    .constant('api', 'https://www.googleapis.com/books/v1/volumes');\n\n})();\nangular.module(\"book\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/components/bookDialog.html\",\"<md-dialog aria-label=\\\"Book Dialog\\\"><form ng-cloak><md-toolbar><div class=md-toolbar-tools><h2>{{dialog.book.volumeInfo.title}}</h2><span flex></span><md-button class=md-icon-button ng-click=dialog.cancel()><i class=material-icons>close</i></md-button></div></md-toolbar><md-dialog-content><div class=md-dialog-content><img ng-src=\\\"{{ dialog.book.volumeInfo.imageLinks.thumbnail }}\\\"><p>{{dialog.book.volumeInfo.description}}</p><ul><li>Etag: {{dialog.book.etag}}</li><li>Id: {{dialog.book.id}}</li><li>Language: {{dialog.book.volumeInfo.language}}</li><li>Rating: {{dialog.book.volumeInfo.ratingsCount}}</li></ul></div></md-dialog-content></form></md-dialog>\");\n$templateCache.put(\"app/favorites/favorites.html\",\"<div flex layout-fill><section class=list-events><md-subheader class=md-primary>{{favorites.items.length}} Livros favoritos</md-subheader><div card-book items=favorites.items router=favorites></div></section></div>\");\n$templateCache.put(\"app/main/main.html\",\"<div flex layout-fill><!-- loading --><div layout-fill layout-align=\\\"center center\\\" layout=column ng-show=main.searching><md-progress-circular md-mode=indeterminate md-diameter=60></md-progress-circular></div><!-- paginacao rapidinha --><div flex layout=row ng-show=\\\"!main.searching && main.items.length > 0\\\" layout-align=\\\"center center\\\" class=md-paginate><button class=md-paginate-button ng-class=\\\"{\\'active\\': $index == main.startIndex}\\\" ng-click=main.search($index) ng-repeat=\\\"n in [].constructor(main.totalPages) track by $index\\\">{{$index + 1}}</button></div><!-- items --><section ng-show=\\\"main.items.length > 0 && !main.searching\\\" class=list-events><md-subheader class=md-primary>Pesquisando por: {{main.searchTerm}} - {{main.totalItems}} Resultados encontrados</md-subheader><div card-book items=main.items search-term={{main.searchTerm}}></div></section></div>\");\n$templateCache.put(\"app/components/card/card.html\",\"<md-card ng-repeat=\\\"item in card.items\\\"><md-card-title><md-card-title-media><div class=\\\"md-media-sm card-media\\\"><a href=javascript:void(0) ng-click=\\\"card.openBookDetail($event, item)\\\"><img ng-src=\\\"{{ item.volumeInfo.imageLinks.thumbnail }}\\\" alt=\\\"{{ item.volumeInfo.title }}\\\"></a></div></md-card-title-media><md-card-title-text><span class=md-headline>{{ item.volumeInfo.title }}</span> <span class=md-subhead ng-bind-html=\\\"item.volumeInfo.description | highlight:card.searchTerm\\\"></span></md-card-title-text></md-card-title><md-divider></md-divider><md-card-actions layout=row layout-align=\\\"end center\\\"><md-button class=md-icon-button ng-click=\\\"card.openBookDetail($event, item)\\\"><i class=material-icons>launch</i><md-tooltip md-direction=top>Detalhes</md-tooltip></md-button><md-button class=md-icon-button ng-click=card.addToFavorites(item) ng-show=!card.router><i class=material-icons>favorite</i><md-tooltip md-direction=top>Adicionar a Favoritos</md-tooltip></md-button><md-button class=md-icon-button ng-click=\\\"card.removeToFavorites($event, item)\\\" ng-show=card.router><i class=material-icons><i class=material-icons>delete</i></i><md-tooltip md-direction=top>Remover dos Favoritos</md-tooltip></md-button></md-card-actions></md-card>\");\n$templateCache.put(\"app/components/navbar/navbar.html\",\"<md-toolbar class=md-hue-2><div class=md-toolbar-tools><a ui-sref=home title=\\\"Books - Home\\\"><h2>Books</h2></a><span flex></span> <input ng-model=vm.txtSearch id=input-search class=md-input-search placeholder=\\\"pesquise aqui os livros...\\\" ng-keyup=\\\"$event.keyCode == 13 && vm.goSearch()\\\"> <span flex></span><md-button class=md-icon-button ng-click=vm.goSearch()><i class=material-icons>search</i><md-tooltip md-direction=left>Pesquisar</md-tooltip></md-button><md-button ui-sref=favorites class=md-icon-button><i class=material-icons>favorite</i><md-tooltip md-direction=left>Meus Favoritos</md-tooltip></md-button></div></md-toolbar>\");}]);"],"sourceRoot":"/source/"}